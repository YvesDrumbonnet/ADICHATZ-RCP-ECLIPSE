/**********************************************************************************************
 * This class was automatically generated by Adichatz tools on Fri Feb 07 15:54:06 CET 2020
 *
 * 				+----------------------------------------+
 * 				| BE CAREFUL BEFORE UPDATING THIS CLASS! |
 * 				+----------------------------------------+
 *
 * Changes will be transient up to next generation process.
 * **********************************************************************************************/
package org.adichatz.studio.gencode.editor;

import net.miginfocom.swt.MigLayout;
import org.adichatz.engine.common.AdichatzApplication;
import org.adichatz.engine.common.EngineConstants;
import org.adichatz.engine.common.EngineTools;
import org.adichatz.engine.controller.IContainerController;
import org.adichatz.engine.controller.collection.IncludeController;
import org.adichatz.engine.core.AFormPageCore;
import org.adichatz.engine.core.ATreeCore;
import org.adichatz.engine.core.EntityManagerCore;
import org.adichatz.engine.extra.AdiResourceURI;
import org.adichatz.engine.indigo.controller.LegacyFormPageController;
import org.adichatz.engine.plugin.AdiContext;
import org.adichatz.engine.plugin.ParamMap;

@AdiResourceURI(URI="adi://org.adichatz.studio/editor/ScenarioEditor")
public class ScenarioEditorGenerationPage extends AFormPageCore {
	// the LegacyFormPageController generationPageFP.
	protected LegacyFormPageController generationPageFP;
	// the IncludeController generationTBMINCL.
	private IncludeController generationTBMINCL;
	protected ATreeCore scenarioEditorGenerationTree;
	/**
	 * Creates the formPage ScenarioEditorGenerationPage.
	 *
	 * @param context
	 *            The context of the root controller
	 * @param parentController
	 *            The parent controller
	 * @param managedForm
	 *            The managed form
	 */
	public ScenarioEditorGenerationPage(final AdiContext context, IContainerController parentController) {
		super(context);
		this.parentController = parentController;
		createContents();
	}

	/**
	 * Create contents for FormPage
	 */
	public void createContents(){
		// Creates control for LegacyFormPageController generationPageFP
		generationPageFP = new LegacyFormPageController("generationPage", parentController, this) {
			@Override
			public void createControl() {
				super.createControl();
				if (isValid()) {
					getControl().getForm().setText(AdichatzApplication.getInstance().getMessage("org.adichatz.studio", "adichatzStudio", "scenario.generation.formText", ((String) context.getParam("pluginName"))));
					getComposite().setLayout(new MigLayout("wrap","[grow,fill]","[grow,fill]"));
				}
			}
		};
		coreController = generationPageFP;
		// Creates control for IncludeController generationTBMINCL
		String generationTBMIK = "adi://editor/ScenarioTBM";
		if (!EngineTools.isEmpty(generationTBMIK)) {
			final String[] generationTBMKeys = EngineTools.getInstanceKeys(generationTBMIK);
			generationTBMINCL = new IncludeController("generationTBM", generationPageFP, new EntityManagerCore(getContext())) {
				@Override
				public void createContents() {
					// loads and instantiates the class generationTBMINCL.
					if (null != EngineConstants.GENERATOR) {
						pluginResources = null == generationTBMKeys[0] ? getPluginResources() : AdichatzApplication.getPluginResources(generationTBMKeys[0]);
						instantiateIncludeClass(pluginResources, generationTBMKeys[2], generationTBMKeys[1], new Class[] {ParamMap.class, IContainerController.class, String.class, AdiContext.class}, new Object[] {getParamMap(), this, "generationTBM", context});
					} else
						new ScenarioTBM(getParamMap(), this, "generationTBM", context).createContents();
				}
			};
		}
		
		// loads and instantiates the class ScenarioEditorGenerationTree.
		scenarioEditorGenerationTree  = new ScenarioEditorGenerationTree(context, generationPageFP);
	}

}