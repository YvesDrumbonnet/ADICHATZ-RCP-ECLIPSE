/**********************************************************************************************
 * This class was automatically generated by Adichatz tools on Tue Jul 07 08:03:21 CEST 2020
 *
 * 				+----------------------------------------+
 * 				| BE CAREFUL BEFORE UPDATING THIS CLASS! |
 * 				+----------------------------------------+
 *
 * Changes will be transient up to next generation process.
 * **********************************************************************************************/
package org.adichatz.studio.gencode.editor;

import net.miginfocom.swt.MigLayout;
import org.adichatz.engine.common.AdichatzApplication;
import org.adichatz.engine.common.EngineConstants;
import org.adichatz.engine.common.EngineTools;
import org.adichatz.engine.controller.IContainerController;
import org.adichatz.engine.controller.collection.IncludeController;
import org.adichatz.engine.controller.collection.ScrolledCompositeController;
import org.adichatz.engine.core.AFormPageCore;
import org.adichatz.engine.core.EntityManagerCore;
import org.adichatz.engine.extra.AdiResourceURI;
import org.adichatz.engine.indigo.controller.LegacyFormPageController;
import org.adichatz.engine.listener.AControlListener;
import org.adichatz.engine.listener.AdiEvent;
import org.adichatz.engine.listener.IEventType;
import org.adichatz.engine.plugin.AdiContext;
import org.adichatz.engine.plugin.ParamMap;
import org.adichatz.studio.xjc.controller.DatasourceComboController;
import org.adichatz.studio.xjc.controller.ModelCheckBoxController;

@AdiResourceURI(URI="adi://org.adichatz.studio/editor/ScenarioEditor")
public class ScenarioEditorModelPage extends AFormPageCore {
	// the LegacyFormPageController modelPageFP.
	protected LegacyFormPageController modelPageFP;
	// the IncludeController modelTBMINCL.
	private IncludeController modelTBMINCL;
	// the ScrolledCompositeController scrolledCompositeSCLC.
	protected ScrolledCompositeController scrolledCompositeSCLC;
	protected EntityManagerCore scenarioEditorGenerationScenarioComposite;
	protected EntityManagerCore scenarioEditorModelSection;
	/**
	 * Creates the formPage ScenarioEditorModelPage.
	 *
	 * @param context
	 *            The context of the root controller
	 * @param parentController
	 *            The parent controller
	 * @param managedForm
	 *            The managed form
	 */
	public ScenarioEditorModelPage(final AdiContext context, IContainerController parentController) {
		super(context);
		this.parentController = parentController;
		createContents();
	}

	/**
	 * Create contents for FormPage
	 */
	public void createContents(){
		// Creates control for LegacyFormPageController modelPageFP
		modelPageFP = new LegacyFormPageController("modelPage", parentController, this) {
			@Override
			public void createControl() {
				super.createControl();
				if (isValid()) {
					getControl().getForm().setText(AdichatzApplication.getInstance().getMessage("org.adichatz.studio", "adichatzStudio", "scenario.model.formText", ((String) context.getParam("pluginName"))));
					getComposite().setLayout(new MigLayout("wrap","[grow,fill]","[grow,fill]"));
				}
			}
		};
		coreController = modelPageFP;
		// Creates control for IncludeController modelTBMINCL
		String modelTBMIK = "adi://editor/ScenarioTBM";
		if (!EngineTools.isEmpty(modelTBMIK)) {
			final String[] modelTBMKeys = EngineTools.getInstanceKeys(modelTBMIK);
			modelTBMINCL = new IncludeController("modelTBM", modelPageFP, new EntityManagerCore(getContext())) {
				@Override
				public void createContents() {
					// loads and instantiates the class for 'modelTBMINCL' include wrapper.
					if (null != EngineConstants.GENERATOR) {
						pluginResources = null == modelTBMKeys[0] ? getPluginResources() : AdichatzApplication.getPluginResources(modelTBMKeys[0]);
						instantiateIncludeClass(pluginResources, modelTBMKeys[2], modelTBMKeys[1], new Class[] {ParamMap.class, IContainerController.class, String.class, AdiContext.class}, new Object[] {getParamMap(), this, "modelTBM", context});
					} else
						new ScenarioTBM(getParamMap(), this, "modelTBM", context).createContents();
				}
			};
		}
		// Creates control for ScrolledCompositeController scrolledCompositeSCLC
		scrolledCompositeSCLC = new ScrolledCompositeController("scrolledComposite", modelPageFP, this) {
			@Override
			public void initialize() {
				AControlListener scrolledCompositeLSTN$0 = new AControlListener("AFTER_END_LIFE_CYCLE", IEventType.AFTER_END_LIFE_CYCLE) {
					@Override
					public void handleEvent(AdiEvent event) {
						boolean enabled = !((ModelCheckBoxController) getFromRegister("modelPart")).getValue();
						((ModelCheckBoxController) getFromRegister("modelPart")).getControl().setEnabled(enabled);
						if (!enabled) {
						    ((DatasourceComboController) getFromRegister("connectorDataSource")).getControl().setEnabled(enabled);
						}
					}
				};
				addListener(scrolledCompositeLSTN$0);
				super.initialize();
			}
			@Override
			public void createControl() {
				super.createControl();
				if (isValid()) {
					getComposite().setLayout(new MigLayout("wrap","[grow,fill]","[grow,fill][]"));
					getControl().setLayoutData("w 0:n:n, h 0:n:n");
				}
			}
		};
		
		// loads and instantiates the class ScenarioEditorGenerationScenarioComposite.
		scenarioEditorGenerationScenarioComposite  = new ScenarioEditorGenerationScenarioComposite(context, scrolledCompositeSCLC);
		
		// loads and instantiates the class ScenarioEditorModelSection.
		scenarioEditorModelSection  = new ScenarioEditorModelSection(context, scrolledCompositeSCLC);
	}

}